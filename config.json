{
  "server": {
    "name": "aws-pr-review",
    "version": "1.0.0",
    "description": "AWS PR Review MCP Server",
    "max_concurrent_requests": 10,
    "request_timeout_seconds": 30
  },
  "aws": {
    "default_region": "us-east-1",
    "regions": [
      "us-east-1",
      "us-west-2",
      "eu-west-1",
      "eu-central-1",
      "ap-northeast-1",
      "ap-southeast-1"
    ],
    "services": {
      "ec2": {
        "enabled": true,
        "check_security_groups": true,
        "check_public_ips": true,
        "check_instance_types": true
      },
      "s3": {
        "enabled": true,
        "check_encryption": true,
        "check_public_access": true,
        "check_versioning": true,
        "check_lifecycle_policies": true
      },
      "lambda": {
        "enabled": true,
        "check_runtime_versions": true,
        "check_permissions": true,
        "check_vpc_config": true,
        "check_environment_variables": true
      },
      "rds": {
        "enabled": true,
        "check_encryption": true,
        "check_backup_settings": true,
        "check_multi_az": true,
        "check_public_access": true
      },
      "iam": {
        "enabled": true,
        "check_policy_permissions": true,
        "check_trust_relationships": true,
        "check_unused_policies": true
      },
      "vpc": {
        "enabled": true,
        "check_flow_logs": true,
        "check_nacls": true,
        "check_route_tables": true
      }
    },
    "assume_role": {
      "enabled": false,
      "role_arn": "",
      "session_name": "aws-pr-mcp",
      "duration_seconds": 3600
    }
  },
  "security": {
    "enable_secrets_detection": true,
    "enable_compliance_checking": true,
    "severity_levels": ["critical", "high", "medium", "low"],
    "default_severity_threshold": "medium",
    "max_findings_per_category": 50,
    "secrets_patterns": {
      "aws_access_key": "AKIA[0-9A-Z]{16}",
      "aws_secret_key": "[A-Za-z0-9/+=]{40}",
      "generic_password": "password\\s*=\\s*[\"'][^\"']{8,}[\"']",
      "generic_secret": "secret\\s*=\\s*[\"'][^\"']{16,}[\"']",
      "api_key": "api[_-]?key\\s*=\\s*[\"'][^\"']{16,}[\"']"
    },
    "dangerous_ports": [22, 3389, 1433, 3306, 5432, 6379, 27017],
    "allowed_public_ports": [80, 443, 8080, 8443]
  },
  "compliance": {
    "frameworks": {
      "SOC2": {
        "enabled": true,
        "requirements": [
          "encryption_at_rest",
          "encryption_in_transit",
          "access_controls",
          "audit_logging",
          "change_management"
        ]
      },
      "GDPR": {
        "enabled": true,
        "requirements": [
          "data_encryption",
          "data_retention_policies",
          "audit_logging",
          "privacy_by_design"
        ]
      },
      "HIPAA": {
        "enabled": true,
        "requirements": [
          "phi_encryption",
          "access_controls",
          "audit_logging",
          "breach_notification"
        ]
      },
      "PCI": {
        "enabled": false,
        "requirements": [
          "cardholder_data_encryption",
          "network_segmentation",
          "access_controls",
          "security_testing"
        ]
      },
      "ISO27001": {
        "enabled": false,
        "requirements": [
          "information_security_management",
          "risk_assessment",
          "security_controls",
          "continuous_improvement"
        ]
      }
    }
  },
  "cost_analysis": {
    "enabled": true,
    "currency": "USD",
    "regions_pricing": {
      "us-east-1": "default",
      "us-west-2": "default",
      "eu-west-1": "eu",
      "ap-northeast-1": "apac"
    },
    "instance_pricing": {
      "ec2": {
        "t3.micro": 0.0104,
        "t3.small": 0.0208,
        "t3.medium": 0.0416,
        "t3.large": 0.0832,
        "m5.large": 0.096,
        "m5.xlarge": 0.192,
        "c5.large": 0.085,
        "c5.xlarge": 0.17
      },
      "rds": {
        "db.t3.micro": 0.017,
        "db.t3.small": 0.034,
        "db.t3.medium": 0.068,
        "db.r5.large": 0.24,
        "db.r5.xlarge": 0.48
      }
    },
    "storage_pricing": {
      "ebs_gp3": 0.08,
      "ebs_gp2": 0.10,
      "ebs_io1": 0.125,
      "s3_standard": 0.023,
      "s3_ia": 0.0125,
      "s3_glacier": 0.004
    },
    "enable_cost_alerts": true,
    "monthly_budget_threshold": 1000
  },
  "infrastructure_as_code": {
    "cloudformation": {
      "enabled": true,
      "check_template_validation": true,
      "check_stack_policies": true,
      "check_outputs": true,
      "check_parameters": true
    },
    "terraform": {
      "enabled": true,
      "check_provider_versions": true,
      "check_state_backend": true,
      "check_resource_naming": true,
      "check_variables": true
    },
    "cdk": {
      "enabled": false,
      "check_constructs": true,
      "check_aspects": true
    }
  },
  "reporting": {
    "output_format": "detailed",
    "include_recommendations": true,
    "include_code_examples": true,
    "group_by_severity": true,
    "max_report_size_mb": 10,
    "export_formats": ["json", "html"],
    "template_path": "./templates"
  },
  "caching": {
    "enabled": true,
    "ttl_seconds": 3600,
    "max_cache_size_mb": 100,
    "cache_aws_responses": true,
    "cache_analysis_results": true
  },
  "performance": {
    "max_memory_usage_mb": 512,
    "connection_pool_size": 20,
    "concurrent_analysis_limit": 5,
    "chunk_size_for_large_files": 1048576
  },
  "logging": {
    "level": "INFO",
    "format": "json",
    "file": "aws-pr-mcp.log",
    "max_file_size_mb": 100,
    "backup_count": 5,
    "enable_audit_logging": true,
    "audit_log_file": "audit.log"
  },
  "integrations": {
    "github": {
      "enabled": false,
      "webhook_secret": "",
      "check_branch_protection": true,
      "auto_comment_on_pr": false
    },
    "slack": {
      "enabled": false,
      "webhook_url": "",
      "channel": "#security-alerts",
      "notify_on_critical": true,
      "notify_on_high": false
    },
    "email": {
      "enabled": false,
      "smtp_config": {
        "host": "",
        "port": 587,
        "use_tls": true,
        "username": "",
        "password": ""
      },
      "from_address": "",
      "to_addresses": [],
      "notify_on_critical": true
    }
  },
  "custom_rules": {
    "enabled": true,
    "rules_path": "./config/custom_rules.yaml",
    "policies_path": "./config/custom_policies.json",
    "allow_rule_override": false
  },
  "rate_limiting": {
    "enabled": true,
    "requests_per_minute": 60,
    "burst_size": 10,
    "enable_per_user_limits": false
  }
}